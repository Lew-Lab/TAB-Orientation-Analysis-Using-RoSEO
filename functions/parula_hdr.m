function map = parula_hdr(m)
%PARULA Blue-green-orange-yellow color map
%   PARULA_HDR(M) returns an M-by-3 matrix containing a colormap. 
%   The colors begin with dark blue, range through green and orange, and 
%   end with bright yellow/white. PARULA is named
%   after a bird, the tropical parula, which has these colors.
%
%   PARULA returns a colormap with the same number of colors as the current
%   figure's colormap. If no figure exists, MATLAB uses the length of the
%   default colormap.
%
%   EXAMPLE
%
%   This example shows how to reset the colormap of the current figure.
%
%       colormap(parula)
%
%   Modified in Sept. 2017 by Matthew Lew to extend the dynamic range of
%   parula to better render single-molecule super-resolution images on
%   screens (RGB) and in printouts (CMYK).

if nargin < 1
   f = get(groot,'CurrentFigure');
   if isempty(f)
      m = size(get(groot,'DefaultFigureColormap'),1);
   else
      m = size(f.Colormap,1);
   end
end

values = [
0	0.004926667	0.0116
0	0.010466667	0.0353
0	0.016006667	0.059
0	0.021546667	0.0827
0	0.027086667	0.1064
0	0.032626667	0.1301
0	0.038166667	0.1538
0	0.043706667	0.1775
0	0.049246667	0.2012
0	0.054786667	0.2249
0	0.060326667	0.2486
0	0.065866667	0.2723
0	0.071406667	0.296
0	0.076946667	0.3197
0	0.082486667	0.3434
0	0.088026667	0.3671
0	0.093566667	0.3908
0	0.099106667	0.4145
0	0.104646667	0.4382
0	0.110186667	0.4619
0	0.115726667	0.4856
0	0.121266667	0.5093
0	0.126806667	0.533
0	0.132346667	0.5567
0	0.137886667	0.5804
0	0.143426667	0.6041
0	0.148966667	0.6278
0	0.154506667	0.6515
0	0.160046667	0.6752
0	0.165586667	0.6989
0	0.171126667	0.7226
0	0.176666667	0.7463
0	0.182206667	0.77
0.010732143	0.187746667	0.7937
0.021953571	0.193286667	0.8043
0.033175	0.198826667	0.8148
0.044396429	0.204366667	0.8249
0.055617857	0.209906667	0.8346
0.066839286	0.215446667	0.8439
0.078060714	0.220986667	0.8528
0.089282143	0.226526667	0.8612
0.100503571	0.232066667	0.8692
0.111725	0.237606667	0.8767
0.122946429	0.243146667	0.884
0.134167857	0.248686667	0.8908
0.145389286	0.254226667	0.8973
0.156610714	0.2598	0.9035
0.167832143	0.2653	0.9094
0.179053571	0.2708	0.915
0.190275	0.2764	0.9204
0.201496429	0.2819	0.9255
0.212717857	0.2875	0.9305
0.223939286	0.293	0.9352
0.235160714	0.2985	0.9397
0.246382143	0.304	0.9441
0.2598	0.3095	0.9483
0.2653	0.315	0.9524
0.2708	0.3204	0.9563
0.2764	0.3259	0.96
0.2819	0.3313	0.9636
0.2803	0.3367	0.967
0.2798	0.3421	0.9702
0.2791	0.3475	0.9733
0.2784	0.3529	0.9763
0.2776	0.3583	0.9791
0.2766	0.3638	0.9817
0.2754	0.3693	0.984
0.2741	0.3748	0.9862
0.2726	0.3804	0.9881
0.271	0.386	0.9898
0.2691	0.3916	0.9912
0.267	0.3973	0.9924
0.2647	0.403	0.9935
0.2621	0.4088	0.9946
0.2591	0.4145	0.9955
0.2556	0.4203	0.9965
0.2517	0.4261	0.9974
0.2473	0.4319	0.9983
0.2424	0.4378	0.9991
0.2369	0.4437	0.9996
0.2311	0.4497	0.9995
0.225	0.4559	0.9985
0.2189	0.462	0.9968
0.2128	0.4682	0.9948
0.2066	0.4743	0.9926
0.2006	0.4803	0.9906
0.195	0.4861	0.9887
0.1903	0.4919	0.9867
0.1869	0.4975	0.9844
0.1847	0.503	0.9819
0.1831	0.5084	0.9793
0.1818	0.5138	0.9766
0.1806	0.5191	0.9738
0.1795	0.5244	0.9709
0.1785	0.5296	0.9677
0.1778	0.5349	0.9641
0.1773	0.5401	0.9602
0.1768	0.5452	0.956
0.1764	0.5504	0.9516
0.1755	0.5554	0.9473
0.174	0.5605	0.9432
0.1716	0.5655	0.9393
0.1686	0.5705	0.9357
0.1649	0.5755	0.9323
0.161	0.5805	0.9289
0.1573	0.5854	0.9254
0.154	0.5902	0.9218
0.1513	0.595	0.9182
0.1492	0.5997	0.9147
0.1475	0.6043	0.9113
0.1461	0.6089	0.908
0.1446	0.6135	0.905
0.1429	0.618	0.9022
0.1408	0.6226	0.8998
0.1383	0.6272	0.8975
0.1354	0.6317	0.8953
0.1321	0.6363	0.8932
0.1288	0.6408	0.891
0.1253	0.6453	0.8887
0.1219	0.6497	0.8862
0.1185	0.6541	0.8834
0.1152	0.6584	0.8804
0.1119	0.6627	0.877
0.1085	0.6669	0.8734
0.1048	0.671	0.8695
0.1009	0.675	0.8653
0.0964	0.6789	0.8609
0.0914	0.6828	0.8562
0.0855	0.6865	0.8513
0.0789	0.6902	0.8462
0.0713	0.6938	0.8409
0.0628	0.6972	0.8355
0.0535	0.7006	0.8299
0.0433	0.7039	0.8242
0.0328	0.7071	0.8183
0.0234	0.7103	0.8124
0.0155	0.7133	0.8064
0.0091	0.7163	0.8003
0.0046	0.7192	0.7941
0.0019	0.722	0.7878
0.0009	0.7248	0.7815
0.0018	0.7275	0.7752
0.0046	0.7301	0.7688
0.0094	0.7327	0.7623
0.0162	0.7352	0.7558
0.0253	0.7376	0.7492
0.0369	0.74	0.7426
0.0504	0.7423	0.7359
0.0638	0.7446	0.7292
0.077	0.7468	0.7224
0.0899	0.7489	0.7156
0.1023	0.751	0.7088
0.1141	0.7531	0.7019
0.1252	0.7552	0.695
0.1354	0.7572	0.6881
0.1448	0.7593	0.6812
0.1532	0.7614	0.6741
0.1609	0.7635	0.6671
0.1678	0.7656	0.6599
0.1741	0.7678	0.6527
0.1799	0.7699	0.6454
0.1853	0.7721	0.6379
0.1905	0.7743	0.6303
0.1954	0.7765	0.6225
0.2003	0.7787	0.6146
0.2061	0.7808	0.6065
0.2118	0.7828	0.5983
0.2178	0.7849	0.5899
0.2244	0.7869	0.5813
0.2318	0.7887	0.5725
0.2401	0.7905	0.5636
0.2491	0.7922	0.5546
0.2589	0.7937	0.5454
0.2695	0.7951	0.536
0.2809	0.7964	0.5266
0.2929	0.7975	0.517
0.3052	0.7985	0.5074
0.3176	0.7994	0.4975
0.3301	0.8002	0.4876
0.3424	0.8009	0.4774
0.3548	0.8016	0.4669
0.3671	0.8021	0.4563
0.3795	0.8026	0.4454
0.3921	0.8029	0.4344
0.405	0.8031	0.4233
0.4184	0.803	0.4122
0.4322	0.8028	0.4013
0.4463	0.8024	0.3904
0.4608	0.8018	0.3797
0.4753	0.8011	0.3691
0.4899	0.8002	0.3586
0.5044	0.7993	0.348
0.5187	0.7982	0.3374
0.5329	0.797	0.3267
0.547	0.7957	0.3159
0.5609	0.7943	0.305
0.5748	0.7929	0.2941
0.5886	0.7913	0.2833
0.6024	0.7896	0.2726
0.6161	0.7878	0.2622
0.6297	0.7859	0.2521
0.6433	0.7839	0.2423
0.6567	0.7818	0.2329
0.6701	0.7796	0.2239
0.6833	0.7773	0.2155
0.6963	0.775	0.2075
0.7091	0.7727	0.1998
0.7218	0.7703	0.1924
0.7344	0.7679	0.1852
0.7468	0.7654	0.1782
0.759	0.7629	0.1717
0.771	0.7604	0.1658
0.7829	0.7579	0.1608
0.7945	0.7554	0.157
0.806	0.7529	0.1546
0.8172	0.7505	0.1535
0.8281	0.7481	0.1536
0.8389	0.7457	0.1546
0.8495	0.7435	0.1564
0.86	0.7413	0.1587
0.8703	0.7392	0.1615
0.8804	0.7372	0.165
0.8903	0.7353	0.1695
0.9	0.7336	0.1749
0.9093	0.7321	0.1815
0.9184	0.7308	0.189
0.9272	0.7298	0.1973
0.9357	0.729	0.2061
0.944	0.7285	0.2151
0.9523	0.7284	0.2237
0.9606	0.7285	0.2312
0.9689	0.7292	0.240028571
0.977	0.7304	0.248467857
0.9842	0.733	0.256907143
0.99	0.7365	0.265346429
0.9946	0.7407	0.273785714
0.9966	0.7458	0.282225
0.9971	0.7513	0.290664286
0.9976	0.7569	0.299103571
0.9981	0.7626	0.307542857
0.9986	0.7683	0.315982143
0.9991	0.774	0.324421429
0.9996	0.7798	0.332860714
1	0.7856	0.3413
1	0.7915	0.349739286
1	0.7974	0.358178571
1	0.8034	0.366617857
1	0.8095	0.375057143
1	0.8156	0.383496429
1	0.8218	0.391935714
1	0.828	0.400375
1	0.8342	0.408814286
1	0.8404	0.417253571
1	0.8467	0.425692857
1	0.8529	0.434132143
1	0.8591	0.442571429
1	0.8654	0.451010714
1	0.8716	0.45945
1	0.8778	0.467889286
1	0.884	0.476328571
1	0.8902	0.484767857
1	0.8963	0.493207143
1	0.9023	0.501646429
1	0.9084	0.510085714
1	0.9143	0.518525
1	0.9203	0.526964286
1	0.9262	0.535403571
1	0.932	0.543842857
1	0.9379	0.552282143
1	0.9437	0.560721429
1	0.9494	0.569160714
1	0.9552	0.5776
1	0.9609	0.586039286
1	0.9667	0.594478571
1	0.9724	0.602917857
1	0.9782	0.611357143
1	0.9839	0.619796429
1	0.989970476	0.628235714
1	0.995785119	0.636675
1	1	0.645114286
1	1	0.653553571
1	1	0.661992857
1	1	0.670432143
1	1	0.678871429
1	1	0.687310714
1	1	0.69575
1	1	0.704189286
1	1	0.712628571
1	1	0.721067857
1	1	0.729507143
1	1	0.737946429
1	1	0.746385714
1	1	0.754825
1	1	0.763264286
1	1	0.771703571
1	1	0.780142857
1	1	0.788582143
1	1	0.797021429
1	1	0.805460714
1	1	0.8139
1	1	0.822339286
1	1	0.830778571
1	1	0.839217857
1	1	0.847657143
];

P = size(values,1);
map = interp1(1:size(values,1), values, linspace(1,P,m), 'linear');
